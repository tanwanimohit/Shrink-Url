<!DOCTYPE html>
<html lang="en">
<head>
  <title>Dashboard - Tinyforme</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/css?family=Luckiest+Guy|Noto+Sans+JP&display=swap" rel="stylesheet">
  <meta name="google-signin-client_id" content="197776745891-adorjvma9j9k8l4t9r70hul5q7776lfg.apps.googleusercontent.com"> 
  <script src="https://apis.google.com/js/platform.js?onload=renderButton" async defer></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

  <style>
  a:link, a:visited {
	color:white;
  }
	.bg-custom
	{
		background-color:#2979ff;
	}
	.headfont
	{
		font-family: 'Luckiest Guy';
	}
	form
	{
		padding:25px;
		color:white;
		
	}
	form h4
	{
	
		color:white;
		display:inline-block;
	}
	input[type='text']
	{
	border:0px;
	width:40%;
	min-height:4%;
	margin:10px 0px;
	text-align:center;
	font-family: 'Noto Sans JP', sans-serif;
	font-size:1.3em;
	min-width:280px;
	text-decoration:none;
	}

	input[type='button']
	{
	background:#002666;
	border:0px #002666;
	color:white;
	min-height:4%;
	margin:10px 0px;
	width:150px;
	font-family: 'Noto Sans JP', sans-serif;
	font-size:1.3em;
	}
	.mainbody
	{
		height:auto;
	}

	@media only screen and (max-width: 470px) {

	
	input[type='text']
	{
	min-height:7%;
	font-size:1em;
	}
	input[type='button']
	{

	height:7%;
	}
	form h4
	{
		font-size:1.2em;	
	}
	
	.logos	
	{
	font-size:2em;
	}
	}
	.logos	
	{
	color:white;
	font-family: 'Luckiest Guy', cursive;
	font-size:2.5em;

	font-weight:normal;

	}
	#copybtn
	{
		
		margin:0px;
		font-size:12px;
		min-width:0px;
		width:auto;
	}
	
  </style>
</head>
<body  onload="startApp()">

<nav class="navbar navbar-expand-sm bg-custom navbar-dark">
  <a class="navbar-brand headfont" style="margin-top:5px;" href="#" ><h4>Tinyforme!</h4></a>
  
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar" style="border:0px;">
        <img src="<%= data.picture %>" height="30" class="rounded-circle"/> 
  </button>
	<div class="collapse navbar-collapse" id="collapsibleNavbar">
	
		<ul class="navbar-nav ml-auto d-none d-md-block">
		
		  <li class="nav-item" style="margin-top:5px;">
				<a class="nav-link" href="#" style="color:white"><img src="<%= data.picture %>" height="30" class="rounded-circle"/> <%= data.name %> &nbsp; |</a>
		  </li>
		
		</ul>
		<ul class="navbar-nav ">
		
		  <li class="nav-item">
				<a class="nav-link" href="javascript:signOut()" style="color:white" >Logout</a>
		  </li>
		
		</ul>
	</div>
</nav>
<div class="mainbody bg-custom text-center">
<h1 class="logos">Hello, <%= data.name %></h1>
 <form>
<input type="text" id="long" placeholder="Enter Long URL Here..." /><br>
<h4>https://tinyfor.me/ &nbsp;</h4><input type="text" id="short" style="width:20%; min-width:130px" id="short" placeholder="Custom URL " /><br>
<input type="button" onclick="shortURL()" value="Tiny it!" />
<input type="text" id="shorturlcopy" style="min-width:0px; width:0.1px" />
<p id="shorturl">If you don't want to create custom url just leave the other box empty.
</p>
</form>

</div>
<div class="container col-sm-10" style="margin-bottom:15px; margin-top:35px;">
<h5 style="font-family: 'Noto Sans JP', sans-serif;">Recent Shorten Links</h5>
<hr>
</div>


</body>
<script>
  function signOut() {
    var auth2 = gapi.auth2.getAuthInstance();
    auth2.signOut().then(function () {
      window.open("/logout", '_self');
    });
	
  }
  
	function renderButton() {
      gapi.signin2.render('my-signin2', {
        'scope': 'profile email',
        'width': 240,
        'height': 50,
        'longtitle': true,
        'theme': 'dark'
      });
	}
	  
	  
	var startApp = function() {
    gapi.load('auth2', function(){
      // Retrieve the singleton for the GoogleAuth library and set up the client.
      auth2 = gapi.auth2.init({
        client_id: '197776745891-adorjvma9j9k8l4t9r70hul5q7776lfg.apps.googleusercontent.com',
        cookiepolicy: 'single_host_origin',
        // Request scopes in addition to 'profile' and 'email'
        //scope: 'additional_scope'
      });
      
    });
	};
  function shortURL()
	{
		
		var longurl=document.getElementById("long").value;
		var shorturl=document.getElementById("short").value;
		$.post('/shorturl',{longurl:longurl,shorturl:shorturl},function(data,status){
						
					document.getElementById("shorturlcopy").value=" ";

					if(data=="error")
					{	
						alert("Something Went Wrong !");
					}
					else
					{
						
						if(data!="Ahhh! This Custom URL is already Occupied :(" && data!="Please Enter a vaild URL.")
						{
							
							
							document.getElementById("shorturl").innerHTML="Shrinked URL : <a style='font-color:white; text-decoration:none;' href='"+data+"' >"+data+"</a> "+" <input type='button' id='copybtn' onClick='Copy()' data-toggle='tooltip' title='Copied!' value='Copy'/>";
							document.getElementById("shorturlcopy").value=data;
						
						}
						else
						{
							document.getElementById("shorturl").innerHTML=data;
						}
					}
			}
			);
	}
	
	function Copy()
	{
	
		var copyText = document.getElementById("shorturlcopy");
		copyText.select();
		document.execCommand("copy");
	}
	
</script>
</html>
